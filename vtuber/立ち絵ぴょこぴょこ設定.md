# 立ち絵ぴょこぴょこ設定

Discord の Voice 表示(Voice Widget)を カスタムCSSで立ち絵ぴょこぴょこに変換するって仕組みです。

## Voice表示の取得

[Discord STREAMKIT OVERLAY](https://streamkit.discord.com/overlay) を使います。

このページから

1. [Install for OBS] -> [VOICE WIDGET] を選ぶ
2. [Server] に discord サーバーを選ぶ
3. [Voice Channel] で 配信でつかう Voice Channel を選ぶ
4. 右側のURL（https://streamkit.discord.com/overlay/voice と書いてある部分) をコピーして、作成した OBS の ブラウザソースの URL にペーストします。




## カスタムCSSの作成

差し替えは Discord User ID でぴょこぴょこ対象のユーザを選び、
任意の立ち絵（URL指定）に差し替える CSS を OBS ブラウザソースに制定する仕組みです。

> UserIDはDiscordアプリで開発者モードを有効にすると、入室しているユーザーの右クリックで取得できます。
⇒ 開発者モードを有効にする方法: [⚙（ユーザー設定）] -> [詳細設定] -> [開発者モード] を ON


> 立ち絵はURLで指定する必要がありますが、Discordに「#立ち絵置き場」的なテキストチャネルを作って、そこに置いてもらい、それを指定すると良いでしょう。


カスタムCSSは、手で書いてもよいのですが、こちらをつかって生成すると楽

[Discord StreamKit：立ち絵変換](https://manten-do.net/contents/dsk01)

あたしの場合、上記必須情報を入力の後、跳ねる・明度変更をONにしています。

作られたCSSはこんな↓かんじで大変シンプルなので、編集しにくい(T_T) OBS プロパティの カスタムCSSてテキストボックスでもなんとかなるん。
配信中に新規ゲスト様が増えたら既存のOBSブラウザソースを複製して、【discordのユーザーID】と【立ち絵のURL】を手でさしかえ、
ゲスト様がお着替も立ち絵置き場においてもらった新しい絵のURLに差し替え…みたいに運用してます。

```
/* 選択したユーザ以外の画像を非表示にする */
img:not([src*="【discordのユーザーID】"]){ display:none; }
img:not([src*="【discordのユーザーID】"])+div{ display:none; }
li{ position:fixed;top:15px;left:0;right:0;width:100%; }

/* アイコンを立ち絵画像に差し替える */
img[class*="Voice_avatar_"]{
  content:url("【立ち絵のURL】");
  height:auto !important;
  width:100% !important;
  border-radius:0 !important;
  position:absolute;
  left: 50%;
  transform: translateX(-50%);
  -webkit-transform: translateX(-50%);
  -ms-transform: translateX(-50%);
  filter: brightness(50%);
}

/* 発話状態の設定 */
img[class*="Voice_avatarSpeaking"]{
  border-color:rgba(0,0,0,0) !important;
  position:relative;
  animation:speak-now 300ms ease-in-out forwards;
  filter: brightness(100%) ;
}

@keyframes speak-now {
  0% { bottom:0px; }
  50% { bottom:10px; }
  100% { bottom:0px; }
}

/* ネームタグ表示位置調整 */
div[class*='Voice_user']{text-align:center; position:fixed; bottom: 10px; left:0;right:0;margin:auto; }

/* 色々消すヤツ */
body { background-color: rgba(0, 0, 0, 0); overflow: hidden; }

```

配信中に絵を差し替えする必要があったら、content:url のみ変更
